// Este é o seu arquivo de schema do Prisma
// Saiba mais em: https://pris.ly/d/prisma-schema

// 1. Configuração do Cliente (Gera o código TypeScript)
generator client {
  provider      = "prisma-client-js"

  // 1. CORRIGE O ERRO DE BUILD (dizendo para "subir um nível")
  output        = "../node_modules/@prisma/client"

  // 2. CORRIGE O ERRO DE RUNTIME (dizendo qual "motor" usar)
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

// 2. Configuração do Banco (Lê o .env)
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


// --- 3. Modelos da Aplicação ---

// Nosso UserModel "traduzido"
model User {
  id        String   @id @default(cuid()) // Chave primária (substituto do _id)
  email     String   @unique
  name      String
  password  String

  // A Relação: Um Usuário pode ter MUITOS Contatos
  contacts  Contact[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users") // Nome da tabela no Postgres (boa prática)
}

// Nosso ContactModel "traduzido"
model Contact {
  id        String   @id @default(cuid())
  name      String
  email     String?  // O '?' significa que este campo é opcional
  phone     String

  // A Relação: Este Contato pertence a UM Usuário
  user      User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId    String   // Chave estrangeira que armazena o 'id' do Usuário

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("contacts") // Nome da tabela no Postgres
}